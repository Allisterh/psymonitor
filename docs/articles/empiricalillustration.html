<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustration of the Real-Time Monitoring of Bubbles and Ctisis â€¢ psymonitor</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Illustration of the Real-Time Monitoring of Bubbles and Ctisis">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psymonitor</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/index.html">Guides</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itamarcaspi/psymonitor/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Illustration of the Real-Time Monitoring of Bubbles and Ctisis</h1>
                        <h4 class="author">Peter C. B. Phillips</h4>
            <address class="author_afil">
      Yale University<br><h4 class="author">Shuping Shi</h4>
            <address class="author_afil">
      Macquarie University<br><h4 class="author">Itamar Caspi</h4>
            <address class="author_afil">
      Bank of Israel and Bar-Illan University<br><h4 class="date">October, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/itamarcaspi/psymonitor/blob/master/vignettes/empiricalillustration.Rmd"><code>vignettes/empiricalillustration.Rmd</code></a></small>
      <div class="hidden name"><code>empiricalillustration.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      While each financial crisis has its own characteristics, there is now widespread recognition that crises arising sources such as financial speculation and excessive credit creation do inflict harm on the real economy. Detecting speculative market conditions and ballooning credit risk in real time is therefore of prime importance in the complex exercises of market surveillance, risk management, and policy action. This chapter provides an R implementation of the popular real-time monitoring strategy proposed by Phillips, Shi and Yu (2015a,b;PSY), along with a new bootstrap procedure designed to mitigate the potential impact of heteroskedasticity and to effect family-wise size control in recursive testing algorithms. This methodology has been shown effective for bubble and crisis detection (PSY, 2015a,b; Phillips and Shi, 2017) and is now widely used by academic researchers, central bank economists, and fiscal regulators. We illustrate the effectiveness of this procedure with applications to the S&amp;P 500 financial market and the European sovereign debt sector using R.
    </div>
    
<!--
<link href="https://fonts.googleapis.com/css?family=Lato:300|Tangerine|Yantramanav:100" rel="stylesheet">
--->
<p>Before beginning the tutorial, make sure that you have all the necessary packages. Try running the cell below and, if any issues arise, follow the instructions within.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>,
                      <span class="dt">message =</span> <span class="ot">FALSE</span>, <span class="dt">comment =</span> <span class="ot">NA</span>)

<span class="co"># CRAN Packages </span>
<span class="co"># -------------</span>
<span class="co"># If any of these packages are not installed, write</span>
<span class="co"># install.packages("&lt;name of package&gt;")</span>
<span class="co"># e.g., install.packages("MultipleBubbles")</span>

<span class="kw">library</span>(psymonitor)  <span class="co"># For testting for bubble monitoring</span>
<span class="kw">library</span>(ggfortify)   <span class="co"># For time-series plots</span></code></pre></div>
<div id="example-1-the-sp-500-market" class="section level1">
<h1 class="hasAnchor">
<a href="#example-1-the-sp-500-market" class="anchor"></a>Example 1: The S&amp;P 500 Market</h1>
<p>The S&amp;P 500 stock market has been a central focus of attention in global financial markets due to the size of this market and its impact on other financial markets. As an illustration of the methods discussed in this chapter, we conduct a pseudo real-time monitoring exercise for bubbles and crises in this market with the PSY strategy. The sample period runs from January 1973 to July 2018, downloaded monthly from <em>Datastream International</em>. The price-dividend ratio is computed as the inverse of dividend yields. The first step is to import the data to R, using the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(snp)
<span class="co"># date  &lt;- as.Date(sp500[,1],"%d/%m/%Y")</span>
dy    &lt;-<span class="st"> </span>snp
pd    &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>dy</code></pre></div>
<p>In the presence of a speculative bubble, asset prices characteristically deviate in an explosive way from fundamentals, representing exuberance in the speculative behavior driving the market. In the present case, this deviation implies that the log price-dividend ratio is expected to follow an explosive process over the expansive phase of the bubble. But during crisis periods, the price-dividend ratio is expected to follow a random (downward) drift martingale process, in contrast to a small (local to zero) constant drift martingale process that typically applies under normal market conditions. According to the theory detailed in Section 3 and 4, we expect to witness rejection of the null hypothesis in the PSY test empirical outcomes during both bubble and crisis periods.</p>
<p>Figure 1 plots the price-to-dividend ratio of the S&amp;P 500 index. We observe a dramatic increase in the data series in the late 1990s, followed by a rapid fall in the early 2000s. The market experienced another episode of slump in late 2008.</p>
<p><img src="empiricalillustration_files/figure-html/plot-1.png" width="480"></p>
<p>With a training period of 47 observations, we start the pseudo real-time monitoring exercise from November 1976 onwards. The PSY test statistics are compared with the 95% bootstrapped critical value. The empirical size is controlled over a two-year period, i.e., by taking <span class="math inline">\(Tb = 24\)</span>. The lag order is selected by BIC with a maximum lag order of 6, applied to each subsample. The PSY statistic sequence and the corresponding bootstrap critical values can be calculated as follows in R:</p>
<p>First, we set the seed for reproducability of the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set seed for reproducibility</span>
<span class="kw">set.seed</span>(<span class="dv">109</span>)</code></pre></div>
<p>Next, we define the series and paramaters that are used as inputes for the test procedure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y        &lt;-<span class="st"> </span>pd
obs      &lt;-<span class="st"> </span><span class="kw">length</span>(y)
r0       &lt;-<span class="st"> </span><span class="fl">0.01</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.8</span><span class="op">/</span><span class="kw">sqrt</span>(obs)
swindow0 &lt;-<span class="st"> </span><span class="kw">floor</span>(r0<span class="op">*</span>obs)
dim      &lt;-<span class="st"> </span>obs <span class="op">-</span><span class="st"> </span>swindow0 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
IC       &lt;-<span class="st"> </span><span class="dv">2</span>
adflag   &lt;-<span class="st"> </span><span class="dv">6</span>
yr       &lt;-<span class="st"> </span><span class="dv">2</span>
Tb       &lt;-<span class="st"> </span><span class="dv">12</span><span class="op">*</span>yr <span class="op">+</span><span class="st"> </span>swindow0 <span class="op">-</span><span class="st"> </span><span class="dv">1</span></code></pre></div>
<p>Finally, we run the test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bsadf  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PSY.html">PSY</a></span>(y, swindow0, IC, adflag)
Q_SPSY &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wmboot.html">wmboot</a></span>(y, swindow0, IC, adflag, Tb)</code></pre></div>
<p>The identified origination and termination dates can be calculated and viewed with the following commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">date  &lt;-<span class="st"> </span>date[swindow0<span class="op">:</span>t]
Q_PSY &lt;-<span class="st"> </span>Q_SPSY <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> dim)
ind95 &lt;-<span class="st"> </span>(bsadf <span class="op">&gt;</span><span class="st"> </span><span class="kw">t</span>(Q_PSY[<span class="dv">2</span>, ])) <span class="op">*</span><span class="st"> </span><span class="dv">1</span>
OT    &lt;-<span class="st"> </span><span class="kw"><a href="../reference/locate.html">locate</a></span>(ind95, date)
<span class="kw"><a href="../reference/disp.html">disp</a></span>(OT)</code></pre></div>
<p>The identified periods are shaded in green in Figure 2. As is evident in the figure, the procedure detects two bubble episode and one crisis episode. The first bubble episode only lasts for three months (1986M05-M06 and 1987M08) and occurred before the Black Monday crash on October 1987. The second bubble episode is the well-known dot-com bubble, starting from January 1996 and terminating in October 2000 (with several breaks in between). For the dot-com bubble episode the identified starting date for market exuberance occurs well before the speech of the former chairman of the Federal Reserve Bank Alan Greenspan in December 1996 where the now famous question `how do we know when irrational exuberance has unduly escalated asset valuesâ€™ was posed to the audience and financial world. The identified subprime mortgage crisis starts in October 2008, which is one month after the collapse of Lehman Brothers, and terminates in February 2009.</p>
<p>The codes for generating the plot and shaded overlays in the figure are as follows:</p>
<p>Figure 2: Bubble and crisis periods in the S&amp;P 500 stock market. The solid line is the price-to-dividend ratio and the shaded areas are the periods where the PSY statistic exceeds its 95% bootstrapped critical value.</p>
<hr>
</div>
<div id="example-2-credit-risk-in-the-european-sovereign-sector" class="section level1">
<h1 class="hasAnchor">
<a href="#example-2-credit-risk-in-the-european-sovereign-sector" class="anchor"></a>Example 2: Credit Risk in the European Sovereign Sector</h1>
<p>The European sovereign debt sector experienced an extremely turbulent period over the last decade, which caused significant harm to the real economy (Acharya et al., 2018) and led to an unprecedented level of unemployment (Karafolas and Alexandrakis, 2015). The PSY detection algorithm can serve as a useful early warning mechanism for escalating credit risk, which is acknowledged as a leading indicator of financial and economic crises, and thereby enable timely policy action and effective risk management to avert more serious economic damage. To show the potential eficacy of this early warning system, we conduct a pseudo monitoring exercise of credit risk in the European sovereign sector.</p>
<p>Credit risk in the European sovereign sector is proxied by an index constructed as a GDP weighted 10-year government bond yield of the PIIGS (Portugal, Ireland, Italy, Greece, and Spain) countries.5 The PSY strategy is applied to the spread between the PIIGS bond yield index and the 10-year government bond yield of Germany (used as a proxy for a prevailing benchmark of economic fundamentals). The sample data runs from June 1997 to June 2016 and was downloaded from Datastream International. The GDP data are downloaded quarterly and converted to a monthly frequency by assuming a constant value within each quarter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(spread)</code></pre></div>
<p>Figure 3 plots the bond yield spread over the sample period. The bond yield index experienced a rapid and substantial rise between 2008-2009. It continued to mount to historical highs from 2010 onwards and peaked in June 2012. The bond yield index has dropped since then and becomes relatively stable over the last two years. The codes for implementing the PSY procedure are identical to those for Example 1. The estimated start and end dates of the crisis episodes are displayed below.</p>
<p><img src="empiricalillustration_files/figure-html/plotSpread-1.png" width="480"></p>
<p>The shaded areas in Figure 3 are the identified periods of crisis obtained using the 95% bootstrap critical values. The first alarm signal of risk appeared in March 2008 and lasts for one month. The alarm was triggered again after the collapse of Lehman Brothers in October 2008 and turns off in March 2009. The stress indicator switched on again in May 2010 and lasted until August 2012.</p>
<p>Figure 3: Crisis episodes in the European sovereign sector. The solid line is the 10-year government bond yield spread between the PIIGS countries and Germany and the shaded areas are the periods where the PSY statistic exceeds its 95% bootstrap critical value.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#example-1-the-sp-500-market">Example 1: The S&amp;P 500 Market</a></li>
      <li><a href="#example-2-credit-risk-in-the-european-sovereign-sector">Example 2: Credit Risk in the European Sovereign Sector</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://korora.econ.yale.edu/phillips/">Peter C.B. Phillips</a>, <a href="https://sites.google.com/site/shupingshi/home/">Shuping Shi</a>, <a href="http://www.itamarcaspi.net/">Itamar Caspi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
